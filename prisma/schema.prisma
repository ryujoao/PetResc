
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

/// login usuário
model Account {
  id       Int      @id @default(autoincrement())
  email    String   @unique
  password String
  role     Role
  admin    Admin?
  ong      Ong?
  publico  Publico?
}

/// papéis possíveis
enum Role {
  ADMIN
  ONG
  PUBLICO
}

/// Perfil de administrador — usa o mesmo ID da asccount
model Admin {
  id      Int     @id
  nome    String
  account Account @relation(fields: [id], references: [id], onDelete: Cascade)
}

/// Perfil de público geral — usa o mesmo ID da Account
model Publico {
  id      Int     @id
  nome    String
  account Account @relation(fields: [id], references: [id], onDelete: Cascade)
}

/// Perfil de ONG — usa o mesmo ID da Account
model Ong {
  id        Int      @id
  name      String
  cnpj      String?
  descricao String?
  endereco  String?
  account   Account  @relation(fields: [id], references: [id], onDelete: Cascade)
  animals   Animal[] @relation("OngAnimals")
}

model Animal {
  id        Int      @id @default(autoincrement())
  nome      String
  especie   String
  raca      String?
  idade     Int?
  status    StatusAdocao @default(DISPONIVEL)
  porte     String?
  sexo      String?
  descricao String?
  photoURL  String?
  ongId     Int
  ong       Ong      @relation("OngAnimals", fields: [ongId], references: [id])
  denuncias Denuncia[] @relation("AnimalDenuncias")
  
  @@map("animals")
}
/// Estados possíveis no fluxo de adoção
enum StatusAdocao {
  DISPONIVEL
  ADOTADO
  SOBRE_TRATAMENTO
}

model Denuncia {
  id         Int      @id @default(autoincrement())
  descricao  String
  localizacao String
  anonimo   Boolean  @default(false)
  contato    String
  animalId   Int
  animal     Animal   @relation("AnimalDenuncias", fields: [animalId], references: [id])
  createdAt  DateTime @default(now())
  
  @@map("denuncias")
}

/// Estados possíveis para denúncias
enum StatusDenuncia {
  PENDENTE
  EM_ANALISE
  RESOLVIDA
  REJEITADA
}
